@*
	Dependencies:
		Organizer/_OrganizerVM
		utils.js
*@

<script type="text/javascript">
	/*
		organizerData - { id - int, name - string }
	*/
	function OrganizerTreeViewVM(organizerData, itemSelectedCallback) {
		itemSelectedCallback = itemSelectedCallback || (() => {});

		//Proxy to call the callback
		this.ItemSelected = function(item) {
			itemSelectedCallback(item);
		}

		//Call parent constructor last to ensure that patch() is called after all initialization is finished.
		OrganizerVM.call(this, organizerData);
	}

	//Patch documents and categories so that they have an will propagate ItemSelected event.
	CategoryVM.prototype.patch = utils.patch(CategoryVM.prototype.patch, function() {
		this.ItemSelected = utils.patch(this.ItemSelected, function (item) {
			this.parent.ItemSelected(item);
		});
	})

	DocumentVM.prototype.patch = utils.patch(DocumentVM.prototype.patch, function() {
		this.ItemSelected = utils.patch(this.ItemSelected, function (item) {
			this.parent.ItemSelected(item);
		});

		this.Delete = utils.patch(this.Delete, function () {
			this.parent.ItemSelected(null);
		});
	});
</script>